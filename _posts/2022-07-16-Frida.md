---
layout: single
title: "Frida Basic"
categories: Pentest
tag: [Mobile, Android, Pentesting, Frida]
toc: true
toc_sticky: true
toc_label: ëª©ì°¨
author_profile: false
---

## 1ï¸âƒ£ Frida ê¸°ë³¸



#### ğŸ“œ**Frida?**

- Oleê°€ ê°œë°œí•œ DBI(Dynamic Binary Instrumention) í”„ë ˆì„ ì›Œí¬
  (* Instrumentation : ì•±ì´ ì‹¤í–‰ì¤‘ì¸ ìƒíƒœì—ì„œ ì½”ë“œ ëª…ë ¹ì–´ë¥¼ ì‚½ì…í•´ í”„ë¡œì„¸ìŠ¤ë¥¼ ì¶”ì , ë¶„ì„, ë””ë²„ê¹…í•˜ëŠ” ë„êµ¬)



#### ğŸ“œ**Frida íŠ¹ì§•**

- ë‹¤ì–‘í•œ í”Œë«í¼ì—ì„œ í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ì¸ì ì…˜ì´ ê°€ëŠ¥í•´ í° í™•ì¥ì„±ì„ ê°€ì§

- ìœˆë„ìš°, ë§¥OS, GNU/Linux, iOS, Android ë° QNXì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë„¤ì´í‹°ë¸Œ ì•±ì— ì‚½ì…ê°€ëŠ¥

  

#### ğŸ“œ**Frida ì£¼ìš”ê¸°ëŠ¥**

- **í•¨ìˆ˜ í›„í‚¹ (íŠ¹ì • í•¨ìˆ˜ì— ì—°ê²°í•˜ì—¬ ë°˜í™˜ ê°’ ë³€ê²½, í•¨ìˆ˜ ì¬ì‘ì„± ë“±)**
- ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë²„ê¹… ê°€ëŠ¥
- **í™ ë©”ëª¨ë¦¬ ë‚´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ê²€ìƒ‰ ë° ì‚¬ìš©**
- ì‹¤ì‹œê°„ íŠ¸ë˜í”½ ìŠ¤ë‹ˆí•‘ ë˜ëŠ” ì•”í˜¸ í•´ë…
- **íƒˆì˜¥ ë˜ëŠ” ë£¨íŒ…ë˜ì§€ ì•Šì€ ë‹¨ë§ê¸°ì—ì„œë„ ê°€ëŠ¥**



#### ğŸ“œ**ë™ì‘ë°©ì‹**

![img](https://blog.kakaocdn.net/dn/9u1lO/btqBuQhp3gQ/33cmCDC8kKdgtHl8uqqYmk/img.png)



#### ğŸ“œ**Frida Tools**

- frida (frida -h)

  - Frida CLIì¸ REPL ì¸í„°í˜ì´ìŠ¤ë¡œ, ì‹ ì†í•œ í”„ë¡œí† íƒ€ì´í•‘ê³¼ ì†ì‰¬ìš´ ë””ë²„ê¹…ì´ ëª©í‘œì¸ ë„êµ¬

  - "frida -h" ëª…ë ¹ì–´ë¡œ ì˜µì…˜ í™•ì¸ê°€ëŠ¥

    | **ì˜µì…˜**                 | **ì„¤ëª…**                             |
    | ------------------------ | ------------------------------------ |
    | --version                | í”„ë¦¬ë‹¤ í”„ë¡œê·¸ë¨ ë²„ì „ ì¶œë ¥            |
    | -h, --help               | ë„ì›€ë§ ë©”ì‹œì§€ ì¶œë ¥                   |
    | -D ID, --device=ID       | ì£¼ì–´ì§„ IDë¡œ ì¥ì¹˜ì— ì—°ê²°              |
    | -U, --usb                | USB ì¥ì¹˜ì— ì—°ê²°                      |
    | -R, --remote             | ì›ê²© í”„ë¦¬ë‹¤ ì„œë²„ì— ì—°ê²°              |
    | -H Host, --host=Host     | Hostì˜ ì›ê²© í”„ë¦¬ë‹¤ë¦¬ë‹¤ ì„œë²„ì— ì—°ê²°   |
    | -a, --application        | ì• í”Œë¦¬ì¼€ì´ì…˜ ë¦¬ìŠ¤íŠ¸ë§Œ ì¶œë ¥           |
    | -i, --installed          | ì„¤ì¹˜ëœ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ í¬í•¨ ì¶œë ¥   |
    | -l SCRIPT, --load=SCRIPT | SCRIPTë¥¼ ë¡œë“œ                        |
    | -f FILE, --file=FILE     | spawn FILE                           |
    | --no-pause               | ì‹œì‘í•  ë•Œ ìë™ìœ¼ë¡œ ë©”ì¸ì“°ë ˆë“œë¥¼ ì‹œì‘ |

  

- frida-ps (frida-ps -h)

  - Fridaì— ì—°ê²°ëœ í”„ë¡œì„¸ìŠ¤ ëª©ë¡ì„ ì¶œë ¥í•˜ê¸° ìœ„í•œ ë„êµ¬

  - "frida-ps -h" ëª…ë ¹ì–´ë¡œ ì˜µì…˜ í™•ì¸ê°€ëŠ¥

    | **ì˜µì…˜**             | **ì„¤ëª…**                           |
    | -------------------- | ---------------------------------- |
    | --version            | Frida í”„ë¡œê·¸ë¨ ë²„ì „ ì¶œë ¥           |
    | -a, --application    | ì• í”Œë¦¬ì¼€ì´ì…˜ ë¦¬ìŠ¤íŠ¸ë§Œ ì¶œë ¥         |
    | -D ID, --device=ID   | ì£¼ì–´ì§„ IDë¡œ ì¥ì¹˜ì— ì—°ê²°            |
    | -H HOST, --host=HOST | HOSTì˜ ì›ê²© í”„ë¦¬ë‹¤ ì„œë²„ì— ì—°ê²°     |
    | -h, --help           | ë„ì›€ë§ ë©”ì‹œì§€ ì¶œë ¥                 |
    | -i, --installed      | ì„¤ì¹˜ëœ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ í¬í•¨ ì¶œë ¥ |
    | -R, --remote         | ì›ê²© Frida ì„œë²„ì— ì—°ê²°             |
    | -U, --usb            | USB ì¥ì¹˜ì— ì—°ê²°                    |

    

- frida-ls-devices (frida-ps -h)

  - ì—°ê²°ëœ ë””ë°”ì´ìŠ¤ë¥¼ ì¶œë ¥í•˜ëŠ” ë„êµ¬

- frida-trace (frida-trace -h)

  - í•¨ìˆ˜ í˜¸ì¶œì„ ë™ì ìœ¼ë¡œ ì¶”ì í•˜ê¸° ìœ„í•œ ë„êµ¬

  - "frida-trace -h" ëª…ë ¹ì–´ë¡œ ì˜µì…˜ í™•ì¸ê°€ëŠ¥

    | **ì˜µì…˜**                               | **ì„¤ëª…**                       |
    | -------------------------------------- | ------------------------------ |
    | --version                              | Frida í”„ë¡œê·¸ë¨ ë²„ì „ ì¶œë ¥       |
    | -h, --help                             | ë„ì›€ë§ ë©”ì‹œì§€ ì¶œë ¥             |
    | -D ID, --device=ID                     | ì£¼ì–´ì§„ IDë¡œ ì¥ì¹˜ì— ì—°ê²°        |
    | -U, --usb                              | USB ì¥ì¹˜ì— ì—°ê²°                |
    | -R, --remote                           | ì›ê²© Frida ì„œë²„ì— ì—°ê²°         |
    | -H HOST, --host=HOST                   | HOSTì˜ ì›ê²© í”„ë¦¬ë‹¤ ì„œë²„ì— ì—°ê²° |
    | -I MODULE, --include-module=MODULE     | MODULE í¬í•¨í•˜ì—¬ ì‹¤í–‰           |
    | -X MODULE, --exclude-module=MODULE     | MODULE ë°°ì œí•˜ê³  ì‹¤í–‰           |
    | -i FUNCTION, --include-module=FUNCTION | FUNCTION í¬í•¨í•˜ì—¬ ì‹¤í–‰         |
    | -x FUNCTION, --exclude-module=FUNCTION | FUNCTION ë°°ì œí•˜ê³  ì‹¤í–‰         |

    

- frida-kill

  - í”„ë¡œì„¸ìŠ¤ë¥¼ ì¢…ë£Œí•˜ëŠ” ë„êµ¬



#### ğŸ“œ**Frida Script**

- Frida ì—ì„œ ì œê³µí•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ API (Javscript, C, SWIFT API)
- Javascript API
  - ê¸°ë³¸ ë¼ˆëŒ€ êµ¬ì¡°

> Java.perform(function(){})
> (í˜„ì¬ ìŠ¤ë ˆë“œê°€ ê°€ìƒë¨¸ì‹ ì— ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ , ì—°ê²°ë˜ì–´ ìˆë‹¤ë©´ functionì„ í˜¸ì¶œ)

```
Java.perform(function(){
/*
    ...
    do sth
    ...
*/
})
```



> Java.use(className)
>
> - ìë°”ìŠ¤í¬ë¦½íŠ¸ Wrapperë¥¼ ClassNameì— ë™ì ìœ¼ë¡œ ê°€ì ¸ì™€ì„œ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ $new()ë¥¼ í˜¸ì¶œí•˜ì—¬ ê°ì²´ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•¨
> - Static, Non-Static ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
> - ë©”ì†Œë“œ êµ¬í˜„ì„ ë³€ê²½í•  ìˆ˜ ìˆê³  ì˜ˆì™¸ë¥¼ ì ìš©í•  ìˆ˜ ìˆìŒ

```
var myClass = Java.use(com.mypackage.name.class) // ì•±ì—ì„œ ì‚¬ìš©í•˜ëŠ” í´ë˜ìŠ¤ì™€ ì—°ë™ë˜ëŠ” myclassë¥¼ ì •ì˜
 
var myClassInstance = myclass.$new(); // myClassë¥¼ í†µí•´ ê°ì²´ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ë° ì •ì˜
 
var result = myClassInstance.myMethod("param") // í´ë˜ìŠ¤ ë‚´ë¶€ì— ìˆëŠ” ë©”ì†Œë“œì— ì ‘ê·¼í•´ ì¸ì ê°’ì„ ë„˜ê²¨ì£¼ê³  í•´ë‹¹ ê²°ê³¼ ê°’ì„ resultì— ë°›ìŒ
 
myClass.myMethod.implementation = function(param){ // ì•±ì—ì„œ ì •ì˜ëœ ë©”ì†Œë“œì˜ êµ¬í˜„ ë‚´ìš©ì„ ì¬ì‘ì„± í•  ìˆ˜ ìˆìŒ
    // do sth
}
```



- ë©”ì†Œë“œ ì¬êµ¬í˜„ ì‹œ, ì£¼ì˜ì !!
  (ë‹¤ìŒì˜ ê²½ìš°ì—ëŠ” **Overload()** ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¬êµ¬í˜„ í•´ì•¼ í•œë‹¤.)

```
1. ì…ë ¥ë°›ì€ ì¸ìˆ˜ê°€ ì—†ëŠ” ë©”ì†Œë“œ
 
myClass.myMethod.overload().implementation = function() {
    // do sth
}
 
2. ë‘ê°œì˜ ë°”ì´íŠ¸ ë°°ì—´ì„ ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ëŠ” ë©”ì†Œë“œ
 
myClass.myMethod.overload("[B","[B").implementation = function(param1, param2){
    // do sth
}
 
3. ì•±ì˜ Contextì™€ Boolean í˜•íƒœì˜ ì¸ìˆ˜ë¡œ ì…ë ¥ë°›ëŠ” ë©”ì†Œë“œ
 
myClass.myMethod.overload("android.context.Context", "boolean").implementation = function(param1, param2){
    // do sth
}
```


---
layout: single
title: "Ansible ì„¤ì¹˜ ë° ì„¤ì •í•˜ê¸°"
categories: ìžë™í™”
tag: [Automation, Ansible, Python]
toc: true
toc_sticky: true
toc_label: ëª©ì°¨
author_profile: false
---

## 1. Ansible ì„¤ì¹˜



#### ðŸ“œCentOS

```cmd
$ yum install -y ansible 
```



#### ðŸ“œUbuntu

```cmd
$ apt install ansible
```



#### ðŸ“œmacOS

```cmd
$ brew install ansible
```



## 2. SSH ë° hosts íŒŒì¼ ì„¤ì •

ì•¤ì„œë¸”ì€ sshë¡œ ì œì–´ ë…¸ë“œì™€ ë§¤ë‹ˆì§€ë“œ ë…¸ë“œê°€ ì—°ê²°ë©ë‹ˆë‹¤. ì•¤ì„œë¸”ì„ ì´ìš©í•˜ì—¬ ìž‘ì—…ì„ ì§„í–‰í•˜ê¸° ì „ì— `authorized_keys`ì— í‚¤ë¥¼ ì¶”ê°€í•˜ì—¬ ì£¼ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. `ssh-copy-id` ëª…ë ¹ì„ ì´ìš©í•˜ì—¬ ê°„íŽ¸í•˜ê²Œ í‚¤ë¥¼ ì„¤ì •í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.



#### ðŸ“œssh key ì„¤ì • - Ansible Control Node ì—ì„œ ì‹¤í–‰

```CMD
# ssh í‚¤ ìƒì„± 
$ ssh-keygen

# ssh í‚¤ ë³µì‚¬ > Managed Node ë¡œ ì—°ê²°í•˜ê¸° ìœ„í•¨
# ssh ì—°ê²°ì„ ì²˜ë¦¬í•  ê³„ì •ìœ¼ë¡œ ì—°ê²° 
$ ssh-copy-id user@test-host.com
```



#### ðŸ“œhosts ì„¤ì • - Ansible Control Node ì—ì„œ ì‹¤í–‰

```CMD
# /etc/ansible/hosts íŒŒì¼ ì—´ê¸°
$ vi /etc/ansible/hosts

# ë§¨ ë°‘ì—ì¤„ì— Managed Node ì¶”ê°€í•´ì£¼ê¸° 
[test_server]
127.0.0.1      >> "Managed Node IPë¡œ ì¶”ê°€"
```



## 3. Ansible ì‹¤í–‰ í…ŒìŠ¤íŠ¸

Ansibleê³¼ ssh ì„¤ì •ì´ ì œëŒ€ë¡œ ë˜ì—ˆëŠ”ì§€  `ping` ìœ¼ë¡œ ë™ìž‘ì„ í™•ì¸í•©ë‹ˆë‹¤.



#### ðŸ“œManaged Node ë¥¼ ëŒ€ìƒìœ¼ë¡œ ping ë™ìž‘ ì‹¤í–‰

```CMD
# managed nodeì— ping ë™ìž‘ ì‹¤í–‰
$ ansible test_server -m ping
$ ansible -u kali test_server -m ping  >> "root ê³„ì •ì´ ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ ë˜ì–´ìžˆì„ ê²½ìš° ê³„ì •ìž…ë ¥"

# ping ê²°ê³¼
"Managed Node IP" | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python"
    }, 
    "changed": false, 
    "ping": "pong"
} 
```



## 4. Ansible Playbook 

Ansibleê³¼ ssh ì„¤ì •ì´ ì œëŒ€ë¡œ ë˜ì—ˆëŠ”ì§€  `ping` ìœ¼ë¡œ ë™ìž‘ì„ í™•ì¸í•©ë‹ˆë‹¤.



#### ðŸ“œManaged Node ë¥¼ ëŒ€ìƒìœ¼ë¡œ ping ë™ìž‘ ì‹¤í–‰

```CMD
# managed nodeì— ping ë™ìž‘ ì‹¤í–‰
$ ansible test_server -m ping
$ ansible -u kali test_server -m ping  >> "root ê³„ì •ì´ ë‹¤ë¥¸ ê³„ì •ìœ¼ë¡œ ë˜ì–´ìžˆì„ ê²½ìš° ê³„ì •ìž…ë ¥"

# ping ê²°ê³¼
"Managed Node IP" | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python"
    }, 
    "changed": false, 
    "ping": "pong"
} 
```



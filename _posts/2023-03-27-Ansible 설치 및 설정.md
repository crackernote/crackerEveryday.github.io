---
layout: single
title: "Ansible 설치 및 설정하기"
categories: 자동화
tag: [Automation, Ansible, Python]
toc: true
toc_sticky: true
toc_label: 목차
author_profile: false
---

## <img src="C:\Users\hjopy\OneDrive\바탕 화면\Jake\blog\blog\crackernote.github.io\assets\images\그림1.png" alt="그림1" style="zoom:6%;" /> Ansible 설치



#### 📜CentOS

```python
$ yum install -y ansible 
```



#### 📜Ubuntu

```python
$ apt install ansible
```



#### 📜macOS

```python
$ brew install ansible
```



## <img src="C:\Users\hjopy\OneDrive\바탕 화면\Jake\blog\blog\crackernote.github.io\assets\images\그림2.png" alt="그림2" style="zoom:6%;" /> SSH 및 hosts 파일 설정

앤서블은 ssh로 제어 노드와 매니지드 노드가 연결됩니다. 앤서블을 이용하여 작업을 진행하기 전에 `authorized_keys`에 키를 추가하여 주는 것이 좋습니다. `ssh-copy-id` 명령을 이용하여 간편하게 키를 설정할 수 있습니다.



#### 📜ssh key 설정 - Ansible Control Node 에서 실행

```CMD
# ssh 키 생성 
$ ssh-keygen

# ssh 키 복사 > Managed Node 로 연결하기 위함
# ssh 연결을 처리할 계정으로 연결 
$ ssh-copy-id user@test-host.com
```



#### 📜hosts 설정 - Ansible Control Node 에서 실행

```CMD
# /etc/ansible/hosts 파일 열기
$ vi /etc/ansible/hosts

# 맨 밑에줄에 Managed Node 추가해주기 
[test_server]
127.0.0.1      >> "Managed Node IP로 추가"
```



## <img src="C:\Users\hjopy\OneDrive\바탕 화면\Jake\blog\blog\crackernote.github.io\assets\images\그림3.png" alt="그림3" style="zoom:6%;" /> Ansible 실행 테스트

Ansible과 ssh 설정이 제대로 되었는지  `ping` 으로 동작을 확인합니다.



#### 📜Managed Node 를 대상으로 ping 동작 실행

```CMD
# managed node에 ping 동작 실행
$ ansible test_server -m ping
$ ansible -u kali test_server -m ping  >> "root 계정이 다른 계정으로 되어있을 경우 계정입력"

# ping 결과
"Managed Node IP" | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python"
    }, 
    "changed": false, 
    "ping": "pong"
} 
```



## <img src="C:\Users\hjopy\OneDrive\바탕 화면\Jake\blog\blog\crackernote.github.io\assets\images\그림4.png" alt="그림4" style="zoom:6%;" /> Ansible Playbook 

Ansible과 ssh 설정이 제대로 되었는지  `ping` 으로 동작을 확인합니다.



#### 📜Managed Node 를 대상으로 ping 동작 실행

```CMD
# managed node에 ping 동작 실행
$ ansible test_server -m ping
$ ansible -u kali test_server -m ping  >> "root 계정이 다른 계정으로 되어있을 경우 계정입력"

# ping 결과
"Managed Node IP" | SUCCESS => {
    "ansible_facts": {
        "discovered_interpreter_python": "/usr/bin/python"
    }, 
    "changed": false, 
    "ping": "pong"
} 
```


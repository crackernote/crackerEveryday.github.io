---
layout: single
title: "ì¿ íŒ¡ ìƒí’ˆ í¬ë¡¤ëŸ¬"
categories: Coding
tag: [Crawler, Coupang]
toc: true
toc_sticky: true
toc_label: ëª©ì°¨
author_profile: false
---

##  <img src="C:\Users\hjopy\OneDrive\ë°”íƒ• í™”ë©´\Jake\blog\blog\crackernote.github.io\assets\images\ê·¸ë¦¼1.png" alt="ê·¸ë¦¼1" style="zoom:6%;" /> ì¿ íŒ¡ ìƒí’ˆ í¬ë¡¤ëŸ¬

#### ğŸ“œì¿ íŒ¡ ìƒí’ˆ í¬ë¡¤ë§

- ë‰´ìŠ¤ ê²€ìƒ‰ ê²°ê³¼ì—ì„œ ì œëª© ë° URL í¬ë¡¤ë§

  - ì¡°ê±´ 1. 100ê°œê¹Œì§€ë§Œ ìƒí’ˆ ì¶”ì¶œ
  - ì¡°ê±´ 2. ê´‘ê³ ìƒí’ˆ í‘œì‹œ
  - ì¡°ê±´ 3. ì—‘ì…€ íŒŒì¼ë¡œ ê²°ê³¼ ì €ì¥
  
  ```python
  import requests
  from bs4 import BeautifulSoup
  import pyautogui
  import openpyxl
  
  keyword = pyautogui.prompt("ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš” >> ")
  
  wb = openpyxl.Workbook('coupang_result.xlsx')
  ws = wb.create_sheet(keyword)
  ws.append(['ìˆœìœ„','ë¸Œëœë“œëª…','ìƒí’ˆëª…','ê°€ê²©','ìƒì„¸í˜ì´ì§€ë§í¬'])
  
  rank = 1
  done = False
  
  for page in range(1,5):
      if done == True:
          break
      print(page, "ë²ˆì§¸ í˜ì´ì§€ ì…ë‹ˆë‹¤.")
      main_url = f"https://www.coupang.com/np/search?&q={keyword}&page={page}"
  
      coupang_header = {
              'Host': 'www.coupang.com',
              'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0',
              'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',
              'Accept-Language': 'ko-KR,ko;q=0.8,en-US;q=0.5,en;q=0.3',
          }
  
      response = requests.get(main_url, headers=coupang_header)
      html = response.text
      soup = BeautifulSoup(html, "html.parser")
  
      links = soup.select("a.search-product-link")
  
      for link in links:
          if len(link.select("span.ad-badge-text")) > 0:
              print("ê´‘ê³ ìƒí’ˆ ì…ë‹ˆë‹¤.")
          else:
              sub_url = "https://www.coupang.com/" + link.attrs['href']
              response = requests.get(sub_url, headers=coupang_header)
              html = response.text
              soup = BeautifulSoup(html, "html.parser")
              
              try:
                  brand_name = soup.select_one("a.prod-brand-name").text
              except:
                  brand_name = ""
  
              product_name = soup.select_one("h2.prod-buy-header__title").text
              
              try:
                  product_price = soup.select_one("span.total-price > strong").text
              except:
                  product_price =""
  
              print(rank, brand_name, product_name, product_price)
              ws.append([rank, brand_name, product_name, product_price, sub_url])
              rank = rank + 1
              if rank > 100:
                  done = True
                  break
  wb.save('coupang_result.xlsx')
  ```
  
  
  

